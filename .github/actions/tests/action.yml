name: "Test Delegator"
description: "Delegates testing to the correct stack-specific action"

inputs:
  app-path:
    required: true
    description: string
  language:
    required: true
    description: string
  framework:
    required: true
    description: string

runs:
  using: "composite"
  steps:
    - name: Test Next.js
      if: ${{ contains(inputs.framework, 'nextjs') }}
      uses: ./tests-nextjs

    - name: Test Nuxt.js
      if: ${{ contains(inputs.framework, 'nuxtjs') }}
      uses: ./tests-nuxtjs

    - name: Test JS/TS
      if: ${{ (inputs.language == 'javascript' || inputs.language == 'typescript') && !contains(inputs.framework, 'nextjs') && !contains(inputs.framework, 'nuxtjs') }}
      uses: ./tests-js

    - name: Test fallback
      if: ${{ !contains('nextjs,nuxtjs', inputs.framework) && !(inputs.language == 'javascript' || inputs.language == 'typescript') }}
      run: echo "No test runner configured for ${{ inputs.framework }} (${{ inputs.language }})."
      shell: bash
